{"Name":"ParsingPartnersLicenseRenewalRequest","Description":"Parsing the email message of the request(Community, Community Cloud, Cloud Trial, and more..)","Script":"from SiemplifyAction import *\nimport re\nimport datetime\n\n\ndef main():\n    siemplify = SiemplifyAction()\n\n    enriched_entities = []\n    for alert in siemplify.case.alerts:\n        for event in alert.security_events:\n            name = event.additional_properties['body'].encode('utf-8')\n            FirstName = re.findall(r'First Name [^A-Za-z]+([A-Za-z]+)', name)[0]\n            LastName = re.findall(r'Last Name [^A-Za-z]+([A-Za-z]+)', name)[0]\n            Company = re.findall(r'Company [^A-Za-z]+([A-Za-z]+)', name)[0]\n\n            Country = \"Israel\"\n\n            FirstName = unicode(FirstName, errors='ignore').strip()\n            LastName = unicode(LastName, errors='ignore').strip()\n            enrichment_json = {}\n            enrichment_json['FirstName'] = FirstName\n            enrichment_json['LastName'] = LastName\n            enrichment_json['Country'] = Country\n            enrichment_json['Company'] = Company\n            print(enrichment_json)\n            now = datetime.datetime.now()\n\n            # Adding First and Last name to target entities\n            for entity in siemplify.target_entities:\n                entity.additional_properties['FirstName'] = FirstName\n                entity.additional_properties['LastName'] = LastName\n                entity.additional_properties['Country'] = Country\n                entity.additional_properties['Company'] = Company\n                entity.additional_properties['CreationTime'] = '{0}/{1}/{2}'.format(now.day,now.month,now.year)\n                entity.additional_properties['CreationTime_Year'] = now.year\n                entity.additional_properties['CreationTime_Month'] = now.month\n                entity.additional_properties['CreationTime_Day'] = now.day\n                entity.additional_properties['CreationTime_Week'] = now.strftime(\"%V\")\n\n                enriched_entities.append(entity)\n    if len(enriched_entities) > 0:\n        siemplify.update_entities(enriched_entities)\n   \n    siemplify.result.add_json('Email Enrichment Data', enrichment_json)\n    siemplify.result.add_result_json(enrichment_json)\n    output_message = str(len(enriched_entities)) + ' entities were enriched.'\n    result_value = 'true'\n    siemplify.end(output_message, result_value)\n\n\nif __name__ == \"__main__\":\n    main()","IntegrationIdentifier":"Parsing Form Requests","ScriptResultName":"ScriptResult","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{\"LastName\": \"last_name\", \"Company\": \"Siemplify\", \"FirstName\": \"first_name\", \"Country\": \"Israel\"}","ShowResult":true}],"Creator":"tehila","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":13.0,"TimeoutSeconds":1000,"IsAsync":false,"AsyncPollingIntervalInSeconds":30,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[],"DefaultResultValue":"","PythonVersion":"None","SimulationData":{"Entities":null},"SimulationDataJson":null}