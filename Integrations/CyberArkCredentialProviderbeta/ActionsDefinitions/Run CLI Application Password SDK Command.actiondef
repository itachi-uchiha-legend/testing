{"Name":"Run CLI Application Password SDK Command","Description":"Use the Run CLI Application Password SDK Command action to retrieve the application password from Credential Provider. \nThis action doesnâ€™t run on Google SecOps entities.\n","Script":"from typing import NoReturn\n\nfrom TIPCommon.base.action import Action\nfrom TIPCommon.extraction import extract_action_param\n\nimport constants\nfrom CyberArkCredentialProviderManager import (\n    CyberArkCredentialProviderManager,\n    CommandResult,\n)\nimport exceptions\nimport utils\n\n\nclass RunCLIApplicationPasswordSDKCommand(Action):\n\n    def __init__(self) -> None:\n        super().__init__(constants.RUN_CLI_APP_PASSWORD_SDK_COMMAND_SCRIPT_NAME)\n        self.output_message = \"\"\n        self.error_output_message = (\n            \"Error executing action \"\n            f'\"{constants.RUN_CLI_APP_PASSWORD_SDK_COMMAND_SCRIPT_NAME}\".'\n        )\n\n    def _extract_action_parameters(self) -> None:\n        self.params.integration_parameters = utils.get_integration_parameters(\n            self.soar_action\n        )\n        self.params.custom_sdk_command = extract_action_param(\n            self.soar_action,\n            param_name=\"clipasswordsdk Command\",\n            print_value=True,\n            is_mandatory=True,\n        )\n\n    def _init_api_clients(self) -> CyberArkCredentialProviderManager:\n        return utils.initialize_credential_provider_manager(self.soar_action)\n\n    def _validate_params(self) -> None:\n        utils.validate_ip_address(self.params.integration_parameters.docker_gateway_ip)\n\n    def _perform_action(self, _) -> None:\n        result: CommandResult = self.api_client.execute_custom_sdk_command(\n            command=self.params.custom_sdk_command\n        )\n\n        if result.error:\n            self.error_output_message = (\n                \"Error executing the following command: \"\n                f\"{self.params.custom_sdk_command}. \"\n            )\n            raise exceptions.CyberArkCredentialProviderSDKCommandError(result.error)\n\n        self.output_message = (\n            \"Successfully executed the following CLI Application Password SDK command \"\n            f\"{self.params.custom_sdk_command}.\"\n        )\n        self.soar_action.result.add_result_json({\"result\": result.output})\n\n\ndef main() -> NoReturn:\n    RunCLIApplicationPasswordSDKCommand().run()\n\n\nif __name__ == \"__main__\":\n    main()\n","IntegrationIdentifier":"CyberArkCredentialProviderbeta","ScriptResultName":"is_success","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{\"result\": \"\\\"XXXX\\\"\"}","ShowResult":true}],"Creator":"admin","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":1.0,"TimeoutSeconds":600,"IsAsync":null,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"The command for the CLI Application Password SDK to run. The example of the command is as follows: GetPassword -p AppDescs.AppID=testappid2 -p Query=\"Safe=test;Object=testobject\" -o Password.","Name":"clipasswordsdk Command","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":null,"PythonVersion":"None","SimulationData":{"Entities":[]},"SimulationDataJson":"{\"Entities\": []}"}